```spl
# 13. Hardware Monitoring (하드웨어 모니터링)
# 목적: Fan, Power, Temperature, Disk 하드웨어 이벤트 추적
# 실행: Splunk 검색창에 붙여넣기

index=fortianalyzer earliest=-24h type=event subtype=system \
    (msg="*fan*" OR msg="*power*" OR msg="*temperature*" OR msg="*disk*" OR msg="*raid*" OR msg="*hardware*") \
| eval device = devname \
| eval hardware_type = case(
    match(msg, "(?i)fan"), "Fan",
    match(msg, "(?i)power.*supply|psu"), "Power Supply",
    match(msg, "(?i)temperature|thermal"), "Temperature",
    match(msg, "(?i)disk"), "Disk",
    match(msg, "(?i)raid"), "RAID",
    match(msg, "(?i)memory"), "Memory",
    match(msg, "(?i)cpu"), "CPU",
    1=1, "Other Hardware") \
| eval severity = case(
    match(msg, "(?i)fail|failure|critical|error"), "critical",
    match(msg, "(?i)warning|high|low"), "warning",
    match(msg, "(?i)normal|ok|recover"), "info",
    1=1, level) \
| eval hardware_status = case(
    match(msg, "(?i)fail|failure|down"), "Failed",
    match(msg, "(?i)ok|normal|up|recover"), "Normal",
    match(msg, "(?i)high|exceed"), "High",
    match(msg, "(?i)low"), "Low",
    1=1, "Unknown") \
| eval description = coalesce(logdesc, msg, "No details") \
| table _time, device, hardware_type, severity, hardware_status, description \
| sort -_time \
| head 50
```

**확인할 것**:
- Fan failure 이벤트가 있는가?
- Power supply 이상이 있는가?
- Temperature가 높은가?
- Disk error가 있는가?
- RAID degraded 상태인가?

**주요 Hardware 이벤트**:
- Fan speed low/high/failure
- Power supply failure/redundancy lost
- Temperature high/critical
- Disk failure/bad sectors
- RAID degraded/rebuilding
- Memory error

**Hardware 통계**:
```spl
index=fortianalyzer earliest=-7d type=event subtype=system \
    (msg="*fan*" OR msg="*power*" OR msg="*temperature*" OR msg="*disk*") \
| eval hardware_type = case(
    match(msg, "(?i)fan"), "Fan",
    match(msg, "(?i)power"), "Power",
    match(msg, "(?i)temperature"), "Temperature",
    match(msg, "(?i)disk"), "Disk",
    1=1, "Other") \
| eval severity = case(
    match(msg, "(?i)fail|critical|error"), "critical",
    match(msg, "(?i)warning"), "warning",
    1=1, "info") \
| stats count by devname, hardware_type, severity \
| sort -count
```

**Alert 조건 제안**:
- Fan failure detected (팬 고장)
- Power supply redundancy lost (전원 이중화 상실)
- Temperature > threshold (온도 초과)
- Disk failure (디스크 고장)
- RAID degraded (RAID 저하)

**Temperature 추세**:
```spl
index=fortianalyzer earliest=-7d type=event \
    msg="*temperature*" \
| rex field=msg "temperature[:\s]+(?<temp>\d+)" \
| timechart span=1h avg(temp) as avg_temp by devname
```
```
