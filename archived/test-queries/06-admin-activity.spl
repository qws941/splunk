```spl
# 6. Admin Activity Monitoring (관리자 활동 모니터링)
# 목적: 모든 관리자 로그인, 설정 변경, 권한 변경 추적
# 실행: Splunk 검색창에 붙여넣기

index=fortianalyzer earliest=-24h type=event subtype=system \
    (logid=0105* OR logid=0100044546 OR logid=0100044547) \
| eval activity = case(
    logid="0105032001", "Admin Login Success",
    logid="0105032002", "Admin Login Failed",
    logid="0105032003", "Admin Logout",
    match(logid, "010504"), "Admin Account Change",
    logid="0100044546", "Config Change (CLI)",
    logid="0100044547", "Config Change (GUI)",
    1=1, "Other Admin Activity") \
| eval admin_user = coalesce(user, "N/A") \
| eval source_ip = coalesce(srcip, "N/A") \
| eval device = devname \
| eval description = coalesce(msg, logdesc, "No details") \
| stats count by _time, device, activity, admin_user, source_ip, description \
| sort -_time \
| head 100
```

**확인할 것**:
- 관리자 로그인 실패가 많은가? (무차별 대입 공격 가능성)
- 비정상 시간대 로그인이 있는가? (새벽/휴일)
- 특정 관리자의 활동 패턴은?
- 어떤 IP에서 접속하는가?

**주요 Admin LogID**:
- 0105032001: Admin login success (CLI/GUI/SSH)
- 0105032002: Admin login failed
- 0105032003: Admin logout
- 0105040001: Admin user created
- 0105040002: Admin user modified
- 0105040003: Admin user deleted

**Alert 조건 제안**:
- Login failed count > 5 in 5 minutes (무차별 대입 공격)
- Login success from unknown IP (비정상 접속)
- Admin account changes (권한 변경 감지)
```
