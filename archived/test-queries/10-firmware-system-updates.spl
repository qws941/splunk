```spl
# 10. Firmware & System Updates (펌웨어 및 시스템 업데이트)
# 목적: 펌웨어 업그레이드, 시스템 재시작, 서비스 재시작 추적
# 실행: Splunk 검색창에 붙여넣기

index=fortianalyzer earliest=-30d type=event subtype=system \
    (logid=0104033* OR logid=0104010* OR msg="*upgrade*" OR msg="*reboot*" OR msg="*restart*" OR msg="*firmware*") \
| eval event_type = case(
    match(msg, "(?i)firmware.*upgrade|upgrade.*firmware"), "Firmware Upgrade",
    match(msg, "(?i)reboot|restart.*system"), "System Reboot",
    match(msg, "(?i)service.*restart"), "Service Restart",
    match(msg, "(?i)daemon.*restart"), "Daemon Restart",
    match(msg, "(?i)kernel.*panic"), "Kernel Panic",
    match(msg, "(?i)system.*crash"), "System Crash",
    1=1, "Other System Event") \
| eval device = devname \
| eval severity = case(
    match(event_type, "Crash|Panic"), "critical",
    match(event_type, "Reboot"), "warning",
    1=1, "info") \
| eval firmware_version = coalesce(version, "N/A") \
| eval admin_user = coalesce(user, "system") \
| eval description = coalesce(msg, logdesc, "No details") \
| table _time, device, event_type, severity, firmware_version, admin_user, description \
| sort -_time \
| head 50
```

**확인할 것**:
- 펌웨어 업그레이드가 성공했는가?
- 시스템 재시작이 계획된 것인가?
- 비정상 재시작(crash, panic)이 있는가?
- 서비스 재시작이 자주 발생하는가?

**주요 System LogID**:
- 0104033001: Firmware upgrade started
- 0104033002: Firmware upgrade completed
- 0104033003: Firmware upgrade failed
- 0104010001: System reboot initiated
- 0104010002: System startup
- 0104010003: System shutdown
- 0104010004: Service restarted
- 0104010005: Daemon crashed

**Alert 조건 제안**:
- Firmware upgrade failed (업그레이드 실패)
- Unexpected system reboot (비정상 재시작)
- Service restart > 3 times in 1 hour
- Kernel panic detected

**펌웨어 버전 현황 확인**:
```spl
index=fortianalyzer earliest=-1d latest=now type=event \
| stats latest(_time) as last_seen, latest(version) as firmware_version by devname \
| eval last_seen_human = strftime(last_seen, "%Y-%m-%d %H:%M:%S") \
| table devname, firmware_version, last_seen_human \
| sort devname
```
```
