<form version="1.1" theme="dark">
  <label>Slack ì•Œë¦¼ í…ŒìŠ¤íŠ¸</label>
  <description>FortiGate ì•Œë¦¼ ìœ í˜•ë³„ Slack ë©”ì‹œì§€ í…ŒìŠ¤íŠ¸</description>

  <fieldset submitButton="true" autoRun="false">
    <input type="dropdown" token="alert_type" searchWhenChanged="false">
      <label>ì•Œë¦¼ ìœ í˜• ì„ íƒ</label>
      <choice value="all">ì „ì²´ ì•Œë¦¼ í…ŒìŠ¤íŠ¸ (15ê°œ)</choice>
      <choice value="001">001 - Config Change âš™ï¸</choice>
      <choice value="002">002 - VPN Tunnel Down ğŸ”´</choice>
      <choice value="003">003 - VPN Tunnel Up ğŸŸ¢</choice>
      <choice value="006">006 - CPU/Memory Anomaly ğŸ“Š</choice>
      <choice value="007">007 - Hardware Failure ğŸ”´</choice>
      <choice value="007r">007r - Hardware Restored ğŸŸ¢</choice>
      <choice value="008">008 - HA State Change ğŸ”„</choice>
      <choice value="010">010 - Resource Limit âš ï¸</choice>
      <choice value="011">011 - Admin Login Failed ğŸš«</choice>
      <choice value="012">012 - Interface Down ğŸ”´</choice>
      <choice value="012r">012r - Interface Up ğŸŸ¢</choice>
      <choice value="013">013 - SSL VPN Brute Force ğŸš¨</choice>
      <choice value="015">015 - Abnormal Traffic Spike ğŸ“ˆ</choice>
      <choice value="016">016 - System Reboot ğŸ”„</choice>
      <choice value="017">017 - License Expiry Warning â°</choice>
      <default>007</default>
    </input>
  </fieldset>

  <row>
    <panel>
      <title>í…ŒìŠ¤íŠ¸ ê²°ê³¼</title>
      <table>
        <search>
          <query>| script sendtestalert $alert_type$
| rex field=_raw "(?&lt;status&gt;[âœ“âœ—])\s+(?&lt;alert_id&gt;\d+):\s+(?&lt;result&gt;.+)"
| eval status=if(status="âœ“", "âœ… ì„±ê³µ", "âŒ ì‹¤íŒ¨")
| table status, alert_id, result
| rename status as "ìƒíƒœ", alert_id as "ì•Œë¦¼ ID", result as "ê²°ê³¼"</query>
          <earliest>-1m</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>

  <row>
    <panel>
      <title>ì‚¬ìš© ê°€ëŠ¥í•œ ì•Œë¦¼ ìœ í˜•</title>
      <table>
        <search>
          <query>| makeresults
| eval alerts="001,Config Change,âš™ï¸,ì„¤ì • ë³€ê²½ ì•Œë¦¼|002,VPN Tunnel Down,ğŸ”´,VPN í„°ë„ ë‹¤ìš´|003,VPN Tunnel Up,ğŸŸ¢,VPN í„°ë„ ë³µêµ¬|006,CPU/Memory Anomaly,ğŸ“Š,ë¦¬ì†ŒìŠ¤ ì´ìƒ|007,Hardware Failure,ğŸ”´,í•˜ë“œì›¨ì–´ ì¥ì• |007r,Hardware Restored,ğŸŸ¢,í•˜ë“œì›¨ì–´ ë³µêµ¬|008,HA State Change,ğŸ”„,HA ìƒíƒœ ë³€ê²½|010,Resource Limit,âš ï¸,ë¦¬ì†ŒìŠ¤ í•œê³„|011,Admin Login Failed,ğŸš«,ê´€ë¦¬ì ë¡œê·¸ì¸ ì‹¤íŒ¨|012,Interface Down,ğŸ”´,ì¸í„°í˜ì´ìŠ¤ ë‹¤ìš´|012r,Interface Up,ğŸŸ¢,ì¸í„°í˜ì´ìŠ¤ ë³µêµ¬|013,SSL VPN Brute Force,ğŸš¨,SSL VPN ë¬´ì°¨ë³„ ê³µê²©|015,Abnormal Traffic Spike,ğŸ“ˆ,ë¹„ì •ìƒ íŠ¸ë˜í”½|016,System Reboot,ğŸ”„,ì‹œìŠ¤í…œ ì¬ë¶€íŒ…|017,License Expiry Warning,â°,ë¼ì´ì„ ìŠ¤ ë§Œë£Œ ê²½ê³ "
| makemv delim="|" alerts
| mvexpand alerts
| rex field=alerts "(?&lt;id&gt;[^,]+),(?&lt;name&gt;[^,]+),(?&lt;icon&gt;[^,]+),(?&lt;desc&gt;.+)"
| table id, icon, name, desc
| rename id as "ID", icon as "ì•„ì´ì½˜", name as "ì•Œë¦¼ëª…", desc as "ì„¤ëª…"</query>
          <earliest>-1m</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="count">15</option>
      </table>
    </panel>
  </row>

  <row>
    <panel>
      <title>Webhook ì„¤ì • ìƒíƒœ</title>
      <html>
        <style>
          .webhook-info { padding: 15px; background: #1a1a1a; border-radius: 8px; }
          .webhook-info code { background: #333; padding: 2px 6px; border-radius: 4px; }
        </style>
        <div class="webhook-info">
          <p><strong>ìƒíƒœ:</strong> âœ… ì„¤ì • ì™„ë£Œ</p>
          <p><strong>ì±„ë„:</strong> <code>#security-firewall-alert</code></p>
          <p><strong>ì‚¬ìš©ë²•:</strong> ìœ„ ë“œë¡­ë‹¤ìš´ì—ì„œ ì•Œë¦¼ ì„ íƒ í›„ <strong>Submit</strong> ë²„íŠ¼ í´ë¦­</p>
        </div>
      </html>
    </panel>
  </row>
</form>
