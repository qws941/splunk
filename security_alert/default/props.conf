# ========================================
# Field Extractions and Lookups
# App: security_alert v2.0.4
# ========================================

[fw]
# Automatic LogID Enrichment
LOOKUP-fortigate_logid = fortigate_logid_lookup logid OUTPUT category,severity,notify_slack,notify_email,description,available_fields,field_coverage

# Severity Priority Mapping
LOOKUP-severity_priority = severity_priority_lookup severity OUTPUT priority,numeric_value,color

# Auto Response Actions
LOOKUP-auto_response = auto_response_lookup alert_name OUTPUT action_type,action_command,approval_required,max_executions_per_hour

# Threat Intelligence Enrichment
LOOKUP-abuseipdb = abuseipdb_lookup srcip AS ip OUTPUT risk_score,abuse_confidence_score,country_code,isp,usage_type,is_whitelisted
LOOKUP-virustotal = virustotal_lookup srcip AS ip OUTPUT vt_detection_rate,vt_last_analysis_date,vt_malicious_count,vt_suspicious_count
LOOKUP-ip_whitelist = ip_whitelist_lookup srcip AS ip OUTPUT whitelist_reason,added_by,added_date

# MITRE ATT&CK Mapping
LOOKUP-mitre = fortinet_mitre_lookup logid OUTPUT mitre_tactic,mitre_technique,mitre_id,attack_stage
