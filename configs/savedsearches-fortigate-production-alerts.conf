# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# FortiGate Production Alerts - Real-time Alerts Only
# Channel: #security-firewall-alert (Real-time alerts 001-005)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 001: Config Change (Real-time Alert) - Block Kit Format
# âš ï¸  Suppression: 1m (all real-time alerts standardized)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[001.alert_FortiGate_Config_Change]
description = Real-time FortiGate configuration change alerts with Block Kit UI
disabled = 0
cron_schedule = * * * * *
dispatch.earliest_time = rt-1m
dispatch.latest_time = rt
enableSched = 1
realtime_schedule = 1
schedule_priority = highest
alert.track = 1
alert.digest_mode = 0
alert.suppress = 1
alert.suppress.fields = device, admin, config_path
alert.suppress.period = 1m
action.slack_blockkit = 1
action.slack_blockkit.param.channel = #security-firewall-alert
action.slack_blockkit.param.severity = high
action.slack_blockkit.param.title = ğŸ”§ Config Change Alert
search = index=fw (logid=0100044546 OR logid=0100044547) | eval device = coalesce(devname, "unknown") | eval admin = coalesce(user, "system") | eval config_path = coalesce(cfgpath, "unknown") | eval access_method = case(logid=="0100044546", "CLI", logid=="0100044547", "GUI", 1=1, "Unknown") | eval severity="high" | eval message="Config change on " + device + " by " + admin + " via " + access_method + " - Path: " + config_path | table _time, device, admin, config_path, access_method, severity, message

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 002: VPN Failure (Real-time Alert) - Block Kit Format
# âš ï¸  Suppression: 1m (all real-time alerts standardized)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[002.alert_FortiGate_VPN_Failure]
description = Real-time VPN connection failures with Block Kit UI
disabled = 0
cron_schedule = * * * * *
dispatch.earliest_time = rt-1m
dispatch.latest_time = rt
enableSched = 1
schedule_priority = high
alert.track = 1
alert.digest_mode = 0
alert.suppress = 1
alert.suppress.fields = device, vpn_user, remote_ip
alert.suppress.period = 1m
action.slack_blockkit = 1
action.slack_blockkit.param.channel = #security-firewall-alert
action.slack_blockkit.param.severity = medium
action.slack_blockkit.param.title = ğŸ”’ VPN Failure Alert
search = index=fw (logid=0101037131 OR logid=0101037124 OR logid=0101037134) | eval device = coalesce(devname, "unknown") | eval vpn_user = coalesce(user, "N/A") | eval remote_ip = coalesce(remip, "-") | eval vpn_status = case(logid=="0101037131", "Auth Failed", logid=="0101037124", "Tunnel Down", logid=="0101037134", "Disconnected", 1=1, "Error") | eval vpn_reason = coalesce(reason, msg, "No reason") | eval severity="medium" | eval message="VPN failure on " + device + " - User: " + vpn_user + " (" + remote_ip + ") - Status: " + vpn_status | table _time, device, vpn_user, remote_ip, vpn_status, vpn_reason, severity, message

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 003: LogDev Warning (Real-time Alert) - Block Kit Format
# âš ï¸  Suppression: 1m (all real-time alerts standardized)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[003.alert_FortiAnalyzer_LogDev_Warning]
description = FortiAnalyzer log device warnings with Block Kit UI
disabled = 0
cron_schedule = * * * * *
dispatch.earliest_time = rt-1m
dispatch.latest_time = rt
enableSched = 1
schedule_priority = medium
alert.track = 1
alert.digest_mode = 0
alert.suppress = 1
alert.suppress.fields = logid
alert.suppress.period = 1m
action.slack_blockkit = 1
action.slack_blockkit.param.channel = #security-firewall-alert
action.slack_blockkit.param.severity = medium
action.slack_blockkit.param.title = ğŸ“¡ LogDev Warning
search = index=fw logid=220001 | eval issue_type = case(like(msg, "%offline%"), "Device Offline", like(msg, "%disk%"), "Disk Low", like(msg, "%connection%"), "Connection Error", 1=1, "Log Device Issue") | eval severity_level = upper(level) | eval description = coalesce(msg, "No details") | eval severity="medium" | eval message="LogDev issue: " + issue_type + " - " + severity_level | table _time, logid, severity_level, issue_type, description, severity, message

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 004: Metrics Anomaly (Real-time Alert) - Block Kit Format
# âš ï¸  Suppression: 1m (all real-time alerts standardized)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[004.alert_FortiGate_Metrics_Anomaly]
description = System performance alerts (CPU/Memory high) with Block Kit UI
disabled = 0
cron_schedule = * * * * *
dispatch.earliest_time = rt-1m
dispatch.latest_time = rt
enableSched = 1
realtime_schedule = 1
schedule_priority = high
alert.track = 1
alert.digest_mode = 0
alert.suppress = 1
alert.suppress.fields = device, issue
alert.suppress.period = 1m
action.slack_blockkit = 1
action.slack_blockkit.param.channel = #security-firewall-alert
action.slack_blockkit.param.severity = high
action.slack_blockkit.param.title = ğŸ”¥ Performance Alert
search = index=fw (logid=0100032001 OR logid=0100040704 OR logid=0100040705) | eval device = coalesce(devname, "unknown") | rex field=msg "average CPU:\s+(?<cpu_pct>\d+)" | rex field=msg "memory:\s+(?<mem_pct>\d+)" | eval cpu_pct = tonumber(cpu_pct) | eval mem_pct = tonumber(mem_pct) | where (cpu_pct >= 80 OR mem_pct >= 80) | eval issue = case(cpu_pct >= 80 AND mem_pct >= 80, "CPU & Memory High", cpu_pct >= 80, "CPU High", mem_pct >= 80, "Memory High", 1=1, "Performance") | eval message = coalesce(msg, "Check system") | eval severity="high" | table _time, device, issue, message, cpu_pct, mem_pct, severity

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 005: System Critical (Real-time Alert) - Block Kit Format
# âš ï¸  Suppression: 1m (all real-time alerts standardized)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[005.alert_FortiGate_System_Critical]
description = System critical events and errors with Block Kit UI
disabled = 0
cron_schedule = * * * * *
dispatch.earliest_time = rt-1m
dispatch.latest_time = rt
enableSched = 1
realtime_schedule = 1
schedule_priority = highest
alert.track = 1
alert.digest_mode = 0
alert.suppress = 1
alert.suppress.fields = device, message
alert.suppress.period = 1m
action.slack_blockkit = 1
action.slack_blockkit.param.channel = #security-firewall-alert
action.slack_blockkit.param.severity = critical
action.slack_blockkit.param.title = ğŸš¨ CRITICAL System Alert
search = index=fw (level=critical OR level=error) | eval device = coalesce(devname, "unknown") | eval message = coalesce(msg, "Critical event") | eval severity="critical" | table _time, device, level, message, severity

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 006: Anomaly Detection (Scheduled Alert) - Block Kit Format
# ğŸ” Detects 2x spikes in sessions, CPU, memory vs 7-day baseline
# âš ï¸  Suppression: 15m (prevents alert storm during incidents)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[006.alert_FortiGate_Anomaly_Detection]
description = Anomaly detection for sessions, CPU, and memory (2x above 7-day baseline) with Block Kit UI
disabled = 0
cron_schedule = */5 * * * *
dispatch.earliest_time = -7d
dispatch.latest_time = now
enableSched = 1
schedule_priority = high
alert.track = 1
alert.digest_mode = 0
alert.suppress = 1
alert.suppress.fields = device, anomaly_type
alert.suppress.period = 15m
action.slack_blockkit = 1
action.slack_blockkit.param.channel = #security-firewall-alert
action.slack_blockkit.param.severity = high
action.slack_blockkit.param.title = ğŸ“Š Anomaly Detection Alert
search = index=fw (logid=0100032001 OR logid=0100040704 OR logid=0100040705) | rex field=msg "average CPU:\\s+(?<cpu_pct>\\d+)" | rex field=msg "memory:\\s+(?<mem_pct>\\d+)" | rex field=msg "sessions:\\s+(?<session_count>\\d+)" | eval device = coalesce(devname, "unknown") | eval cpu_pct = tonumber(cpu_pct) | eval mem_pct = tonumber(mem_pct) | eval session_count = tonumber(session_count) | eval is_recent = if(_time >= relative_time(now(), "-5m"), 1, 0) | stats avg(eval(if(is_recent==0, cpu_pct, null()))) as baseline_cpu, avg(eval(if(is_recent==0, mem_pct, null()))) as baseline_mem, avg(eval(if(is_recent==0, session_count, null()))) as baseline_sessions, avg(eval(if(is_recent==1, cpu_pct, null()))) as current_cpu, avg(eval(if(is_recent==1, mem_pct, null()))) as current_mem, avg(eval(if(is_recent==1, session_count, null()))) as current_sessions by device | where (current_cpu >= baseline_cpu * 2) OR (current_mem >= baseline_mem * 2) OR (current_sessions >= baseline_sessions * 2) | eval anomaly_type = case(current_cpu >= baseline_cpu * 2 AND current_mem >= baseline_mem * 2 AND current_sessions >= baseline_sessions * 2, "All Metrics Spike", current_cpu >= baseline_cpu * 2 AND current_mem >= baseline_mem * 2, "CPU & Memory Spike", current_cpu >= baseline_cpu * 2 AND current_sessions >= baseline_sessions * 2, "CPU & Sessions Spike", current_mem >= baseline_mem * 2 AND current_sessions >= baseline_sessions * 2, "Memory & Sessions Spike", current_cpu >= baseline_cpu * 2, "CPU Spike", current_mem >= baseline_mem * 2, "Memory Spike", current_sessions >= baseline_sessions * 2, "Sessions Spike", 1=1, "Unknown") | eval severity="high" | eval message = "Anomaly: " + anomaly_type + " on " + device + " - CPU: " + tostring(round(current_cpu, 0)) + "% (baseline " + tostring(round(baseline_cpu, 0)) + "%), Memory: " + tostring(round(current_mem, 0)) + "% (baseline " + tostring(round(baseline_mem, 0)) + "%), Sessions: " + tostring(round(current_sessions, 0)) + " (baseline " + tostring(round(baseline_sessions, 0)) + ")" | table _time, device, anomaly_type, current_cpu, baseline_cpu, current_mem, baseline_mem, current_sessions, baseline_sessions, severity, message

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 009: General Event Summary (Dashboard Support)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[009.alert_FortiGate_Event_Summary]
description = Hourly event summary
disabled = 0
cron_schedule = 0 * * * *
dispatch.earliest_time = -1h
dispatch.latest_time = now
enableSched = 1
schedule_priority = low
alert.track = 0
action.summary_index = 1
action.summary_index._name = summary_fw
search = index=fw | stats count
