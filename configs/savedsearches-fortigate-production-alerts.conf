# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# FortiGate Production Alerts - Real-time Alerts + Metrics
# Channel 1 (#security-firewall-alert): Real-time alerts (001-005)
# Channel 2 (#security-firewall): LogID-based metric collection (001-2 through 005-2)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 001: Config Change (Channel 1 - Real-time Alert)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[001.alert_FortiGate_Config_Change]
description = Real-time FortiGate configuration change alerts
disabled = 0
cron_schedule = * * * * *
dispatch.earliest_time = rt-1m
dispatch.latest_time = rt
enableSched = 1
realtime_schedule = 1
schedule_priority = highest
alert.track = 1
alert.digest_mode = 0
alert.suppress = 1
alert.suppress.fields = _time, device, user, cfgpath
alert.suppress.period = 5m
action.slack = 1
action.slack.param.channel = #security-firewall-alert
action.slack.param.message = â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nğŸ”§ *Config Change Alert*\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n*ğŸ“ Device:* `$result.device$`\n*ğŸ‘¤ Admin:* `$result.admin$`\n*ğŸ”§ Method:* `$result.access_method$`\n*ğŸ“ Path:* `$result.config_path$`\n\n*ğŸ• Time:* `$result._time$`\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n_Priority: HIGH | Review Required_
search = index=fw (logid=0100044546 OR logid=0100044547) | eval device = coalesce(devname, "unknown") | eval admin = coalesce(user, "system") | eval config_path = coalesce(cfgpath, "unknown") | eval access_method = case(logid=="0100044546", "CLI", logid=="0100044547", "GUI", 1=1, "Unknown") | table _time, device, admin, config_path, access_method

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 002: VPN Failure (Channel 1 - Real-time Alert)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[002.alert_FortiGate_VPN_Failure]
description = Real-time VPN connection failures
disabled = 0
cron_schedule = * * * * *
dispatch.earliest_time = rt-1m
dispatch.latest_time = rt
enableSched = 1
schedule_priority = high
alert.track = 1
alert.digest_mode = 0
alert.suppress = 1
alert.suppress.fields = user, remip
alert.suppress.period = 30m
action.slack = 1
action.slack.param.channel = #security-firewall-alert
action.slack.param.message = â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nğŸ”’ *VPN Failure Alert*\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n*ğŸ“ Device:* `$result.device$`\n*ğŸ‘¤ User:* `$result.vpn_user$`\n*ğŸŒ IP:* `$result.remote_ip$`\n*âš ï¸  Status:* `$result.vpn_status$`\n*ğŸ“‹ Reason:* `$result.vpn_reason$`\n\n*ğŸ• Time:* `$result._time$`\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n_Priority: MEDIUM | Investigate_
search = index=fw (logid=0101037131 OR logid=0101037124 OR logid=0101037134) | eval device = coalesce(devname, "unknown") | eval vpn_user = coalesce(user, "N/A") | eval remote_ip = coalesce(remip, "-") | eval vpn_status = case(logid=="0101037131", "Auth Failed", logid=="0101037124", "Tunnel Down", logid=="0101037134", "Disconnected", 1=1, "Error") | eval vpn_reason = coalesce(reason, msg, "No reason") | dedup device, vpn_user, remote_ip | table _time, device, vpn_user, remote_ip, vpn_status, vpn_reason

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 003: LogDev Warning (Channel 1 - Real-time Alert)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[003.alert_FortiAnalyzer_LogDev_Warning]
description = FortiAnalyzer log device warnings
disabled = 0
cron_schedule = * * * * *
dispatch.earliest_time = rt-1m
dispatch.latest_time = rt
enableSched = 1
schedule_priority = medium
alert.track = 1
alert.digest_mode = 0
alert.suppress = 1
alert.suppress.fields = logid
alert.suppress.period = 12h
action.slack = 1
action.slack.param.channel = #security-firewall-alert
action.slack.param.message = â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nğŸ“¡ *LogDev Warning*\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n*âš ï¸  Issue:* `$result.issue_type$`\n*ğŸš¨ Level:* `$result.severity_level$`\n*ğŸ“‹ Message:* `$result.description$`\n\n*ğŸ” LogID:* `$result.logid$`\n*ğŸ• Time:* `$result._time$`\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n_Priority: MEDIUM | Check System_
search = index=fw logid=220001 | eval issue_type = case(like(msg, "%offline%"), "Device Offline", like(msg, "%disk%"), "Disk Low", like(msg, "%connection%"), "Connection Error", 1=1, "Log Device Issue") | eval severity_level = upper(level) | eval description = coalesce(msg, "No details") | dedup logid, issue_type | table _time, logid, severity_level, issue_type, description

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 004: Metrics Anomaly (Channel 1 - Real-time Alert)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[004.alert_FortiGate_Metrics_Anomaly]
description = System metrics anomaly detection
disabled = 0
cron_schedule = * * * * *
dispatch.earliest_time = rt-1m
dispatch.latest_time = rt
enableSched = 1
realtime_schedule = 1
schedule_priority = high
alert.track = 1
alert.digest_mode = 0
alert.suppress = 1
alert.suppress.fields = devname
alert.suppress.period = 30m
action.slack = 1
action.slack.param.channel = #security-firewall-alert
action.slack.param.message = â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nğŸ”¥ *Metrics Anomaly Alert*\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n*ğŸ“ Device:* `$result.device$`\n*ğŸš¨ Severity:* `$result.severity$`\n*âš ï¸  Anomalies:* `$result.anomaly_types$`\n*ğŸ“‹ Details:* `$result.details$`\n\n*ğŸ• Time:* `$result._time$`\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n_Priority: HIGH | Check Load_
search = index=fw earliest=-1m latest=now | eval device = coalesce(devname, "unknown") | eval cpu_current = coalesce(cpu, 0) | eval mem_current = coalesce(mem, 0) | stats values(cpu_current) as cpu_current, values(mem_current) as mem_current by device | eval anomaly_types = "CPU/Memory" | eval severity = "HIGH" | eval details = "Check system load" | table device, anomaly_types, severity, details

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 005: System Critical (Channel 1 - Real-time Alert)
# âš ï¸  Suppression: 1m (reduced from 15m per user request)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[005.alert_FortiGate_System_Critical]
description = System critical events and errors
disabled = 0
cron_schedule = * * * * *
dispatch.earliest_time = rt-1m
dispatch.latest_time = rt
enableSched = 1
realtime_schedule = 1
schedule_priority = highest
alert.track = 1
alert.digest_mode = 0
alert.suppress = 1
alert.suppress.fields = devname, msg
alert.suppress.period = 1m
action.slack = 1
action.slack.param.channel = #security-firewall-alert
action.slack.param.message = â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nğŸš¨ *CRITICAL System Alert*\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n*ğŸ“ Device:* `$result.device$`\n*ğŸ”´ Level:* `CRITICAL`\n*âš ï¸  Event:* `$result.event_type$`\n*ğŸ“‹ Message:* `$result.message$`\n\n*ğŸ• Time:* `$result._time$`\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n_Priority: CRITICAL | Immediate Action_
search = index=fw level=critical OR level=error | eval device = coalesce(devname, "unknown") | eval event_type = coalesce(subtype, type, "system") | eval message = coalesce(msg, "Critical system event") | dedup device, message | table _time, device, event_type, message

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 001-2: Config Change Metrics (Channel 2 - Summary Index)
# LogID-based metric collection for #security-firewall
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[001-2.metrics_FortiGate_Config_Change]
description = Config change metrics by LogID (0100044546, 0100044547)
disabled = 0
cron_schedule = */5 * * * *
dispatch.earliest_time = -5m
dispatch.latest_time = now
enableSched = 1
schedule_priority = low
alert.track = 0
action.summary_index = 1
action.summary_index._name = summary_fw
search = index=fw (logid=0100044546 OR logid=0100044547) | eval device = coalesce(devname, "unknown") | eval access_method = case(logid=="0100044546", "CLI", logid=="0100044547", "GUI", 1=1, "Unknown") | stats count as event_count, dc(user) as unique_admins, values(user) as admins by logid, device, access_method | eval metric_type="config_change"

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 002-2: VPN Failure Metrics (Channel 2 - Summary Index)
# LogID-based metric collection for #security-firewall
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[002-2.metrics_FortiGate_VPN_Failure]
description = VPN failure metrics by LogID (0101037131, 0101037124, 0101037134)
disabled = 0
cron_schedule = */5 * * * *
dispatch.earliest_time = -5m
dispatch.latest_time = now
enableSched = 1
schedule_priority = low
alert.track = 0
action.summary_index = 1
action.summary_index._name = summary_fw
search = index=fw (logid=0101037131 OR logid=0101037124 OR logid=0101037134) | eval device = coalesce(devname, "unknown") | eval vpn_status = case(logid=="0101037131", "Auth Failed", logid=="0101037124", "Tunnel Down", logid=="0101037134", "Disconnected", 1=1, "Error") | stats count as event_count, dc(user) as unique_users, dc(remip) as unique_ips by logid, device, vpn_status | eval metric_type="vpn_failure"

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 003-2: LogDev Warning Metrics (Channel 2 - Summary Index)
# LogID-based metric collection for #security-firewall
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[003-2.metrics_FortiAnalyzer_LogDev_Warning]
description = LogDev warning metrics by LogID (220001)
disabled = 0
cron_schedule = */5 * * * *
dispatch.earliest_time = -5m
dispatch.latest_time = now
enableSched = 1
schedule_priority = low
alert.track = 0
action.summary_index = 1
action.summary_index._name = summary_fw
search = index=fw logid=220001 | eval issue_type = case(like(msg, "%offline%"), "Device Offline", like(msg, "%disk%"), "Disk Low", like(msg, "%connection%"), "Connection Error", 1=1, "Log Device Issue") | eval severity_level = upper(level) | stats count as event_count, values(msg) as messages by logid, severity_level, issue_type | eval metric_type="logdev_warning"

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 004-2: Metrics Anomaly Metrics (Channel 2 - Summary Index)
# Device performance metrics collection
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[004-2.metrics_FortiGate_Metrics_Anomaly]
description = System metrics anomaly statistics
disabled = 0
cron_schedule = */5 * * * *
dispatch.earliest_time = -5m
dispatch.latest_time = now
enableSched = 1
schedule_priority = low
alert.track = 0
action.summary_index = 1
action.summary_index._name = summary_fw
search = index=fw earliest=-5m latest=now | eval device = coalesce(devname, "unknown") | eval cpu_current = coalesce(cpu, 0) | eval mem_current = coalesce(mem, 0) | stats avg(cpu_current) as avg_cpu, max(cpu_current) as max_cpu, avg(mem_current) as avg_mem, max(mem_current) as max_mem, count as sample_count by device | eval metric_type="system_metrics"

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 005-2: System Critical Metrics (Channel 2 - Summary Index)
# Critical event metrics collection
# âš ï¸  Suppression: 1m (reduced from 15m per user request)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[005-2.metrics_FortiGate_System_Critical]
description = System critical events metrics
disabled = 0
cron_schedule = */5 * * * *
dispatch.earliest_time = -5m
dispatch.latest_time = now
enableSched = 1
schedule_priority = low
alert.track = 0
action.summary_index = 1
action.summary_index._name = summary_fw
search = index=fw level=critical OR level=error | eval device = coalesce(devname, "unknown") | eval event_type = coalesce(subtype, type, "system") | stats count as event_count, values(msg) as messages by level, device, event_type | eval metric_type="critical_events"

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 009: General Event Summary (Dashboard Support)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[009.alert_FortiGate_Event_Summary]
description = Hourly event summary
disabled = 0
cron_schedule = 0 * * * *
dispatch.earliest_time = -1h
dispatch.latest_time = now
enableSched = 1
schedule_priority = low
alert.track = 0
action.summary_index = 1
action.summary_index._name = summary_fw
search = index=fw | stats count
