# Splunk Inputs Configuration
# Location: $SPLUNK_HOME/etc/apps/fortigate/local/inputs.conf
#
# Purpose: Define data inputs for FortiAnalyzer logs

# ============================================================================
# Syslog Input from FortiAnalyzer
# ============================================================================
# FortiAnalyzer forwards logs via Syslog (UDP 514 or TCP 6514)

# Option 1: UDP Syslog (Most Common)
[udp://514]
connection_host = ip
sourcetype = fortinet:fortigate:syslog
index = fw
no_priority_stripping = true
no_appending_timestamp = true

# Option 2: TCP Syslog (More Reliable)
[tcp://6514]
connection_host = ip
sourcetype = fortinet:fortigate:syslog
index = fw
no_priority_stripping = true
no_appending_timestamp = true

# ============================================================================
# Monitor CSV Lookup Files for Changes
# ============================================================================

[monitor://$SPLUNK_HOME/etc/apps/fortigate/lookups/abuseipdb_lookup.csv]
sourcetype = csv
index = _internal
disabled = true

[monitor://$SPLUNK_HOME/etc/apps/fortigate/lookups/virustotal_lookup.csv]
sourcetype = csv
index = _internal
disabled = true

# ============================================================================
# Script-based Inputs (Threat Intelligence Updates)
# ============================================================================

# AbuseIPDB Intelligence Fetcher
[script://./bin/fetch_abuseipdb_intel.py]
interval = 3600
sourcetype = abuseipdb:fetch
index = _internal
disabled = false

# VirusTotal Intelligence Fetcher
[script://./bin/fetch_virustotal_intel.py]
interval = 3600
sourcetype = virustotal:fetch
index = _internal
disabled = false

# ============================================================================
# FortiAnalyzer REST API Input (Alternative to Syslog)
# ============================================================================
# Only enable if NOT using Syslog forwarding

[script://./bin/faz_api_poller.py]
interval = 60
sourcetype = fortinet:fortigate:api
index = fw
disabled = true

# ============================================================================
# Summary Index for Correlation Results
# ============================================================================
# Populated by correlation searches via "collect" command

[monitor://$SPLUNK_HOME/var/run/splunk/dispatch/*/summary.csv]
sourcetype = summary_fw
index = summary_fw
disabled = true
