<?xml version="1.0" encoding="UTF-8"?>
<form version="1.1" theme="dark">
  <label>ğŸ”” Slack Alert Control (No JavaScript)</label>
  <description>JavaScript ì—†ì´ ì‘ë™í•˜ëŠ” Slack ì•Œë¦¼ ì œì–´</description>

  <fieldset submitButton="true" autoRun="false">
    <input type="dropdown" token="alert_name">
      <label>Alert ì„ íƒ</label>
      <choice value="FAZ_Critical_Alerts">ğŸ”´ FAZ Critical Events</choice>
      <choice value="FMG_Policy_Install">ğŸ“¦ FMG Policy Install</choice>
      <choice value="FMG_Policy_CRUD">âœï¸ FMG Policy CRUD</choice>
      <choice value="FMG_Object_CRUD">ğŸ”§ FMG Object CRUD</choice>
      <choice value="Security_High_Severity">âš ï¸ Security High Events</choice>
      <default>FAZ_Critical_Alerts</default>
    </input>

    <input type="dropdown" token="action">
      <label>Action</label>
      <choice value="enable">âœ… Enable Slack</choice>
      <choice value="disable">ğŸ”´ Disable Slack</choice>
      <choice value="test">ğŸ§ª Test Alert</choice>
      <default>enable</default>
    </input>
  </fieldset>

  <row>
    <panel>
      <title>Current Alert Status</title>
      <table>
        <search>
          <query>
| rest /services/saved/searches
| search title IN (FAZ_Critical_Alerts,FMG_Policy_Install,FMG_Policy_CRUD,FMG_Object_CRUD,Security_High_Severity)
| eval slack_enabled=if('action.slack'=1,"ğŸŸ¢ ON","ğŸ”´ OFF")
| table title, disabled, slack_enabled, cron_schedule
| rename title as "Alert Name", disabled as "Disabled", slack_enabled as "Slack Status", cron_schedule as "Schedule"
          </query>
          <earliest>-15m</earliest>
          <latest>now</latest>
          <refresh>30s</refresh>
        </search>
      </table>
    </panel>
  </row>

  <row>
    <panel depends="$action$">
      <title>Alert Control (Form-based)</title>
      <html>
        <div style="padding: 20px; background: #fff3cd; border-radius: 6px;">
          <h4>ğŸ’¡ ì‚¬ìš© ë°©ë²• (JavaScript ì—†ì´)</h4>
          <ol>
            <li>Settings â†’ Searches, reports, and alerts ë©”ë‰´ ì´ë™</li>
            <li>Alert ì´ë¦„ ê²€ìƒ‰: <strong>$alert_name$</strong></li>
            <li>Edit â†’ Actions íƒ­ â†’ Slack ì²´í¬ë°•ìŠ¤ ON/OFF</li>
            <li>Save í´ë¦­</li>
          </ol>
          <p><strong>ì°¸ê³ :</strong> Splunk JavaScriptê°€ ë¹„í™œì„±í™”ë˜ì–´ ìˆì–´ ì§ì ‘ Web UI ì‚¬ìš© í•„ìš”</p>
        </div>
      </html>
    </panel>
  </row>

  <row>
    <panel>
      <title>ğŸ“‹ Alternative: CLI Commands</title>
      <html>
        <div style="padding: 15px; background: #f0f0f0; border-radius: 6px; font-family: monospace;">
          <p><strong>Enable Slack for all alerts:</strong></p>
          <pre style="background: #2d2d2d; color: #f8f8f2; padding: 10px; border-radius: 4px; overflow-x: auto;">
for alert in FAZ_Critical_Alerts FMG_Policy_Install FMG_Policy_CRUD FMG_Object_CRUD Security_High_Severity; do
  curl -k -u admin:password \
    -d "action.slack=1" \
    https://localhost:8089/servicesNS/secmon/search/saved/searches/$alert
done
          </pre>

          <p style="margin-top: 15px;"><strong>Disable Slack for all alerts:</strong></p>
          <pre style="background: #2d2d2d; color: #f8f8f2; padding: 10px; border-radius: 4px; overflow-x: auto;">
for alert in FAZ_Critical_Alerts FMG_Policy_Install FMG_Policy_CRUD FMG_Object_CRUD Security_High_Severity; do
  curl -k -u admin:password \
    -d "action.slack=0" \
    https://localhost:8089/servicesNS/secmon/search/saved/searches/$alert
done
          </pre>
        </div>
      </html>
    </panel>
  </row>
</form>
