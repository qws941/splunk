<?xml version="1.0" encoding="UTF-8"?>
<form version="1.1" theme="dark">
  <label>ğŸ”” Slack Alert Control - FAZ/FMG Alerts (Native)</label>
  <description>Slack ì•Œë¦¼ ìƒíƒœ í™•ì¸ - FortiAnalyzer/FortiManager ì•Œë¦¼ (Simple XML Only)</description>

  <!-- FAZ Critical Alerts -->
  <row>
    <panel>
      <title>ğŸ”´ FAZ Critical Events</title>
      <table>
        <search>
          <query>
| rest /services/saved/searches/FAZ_Critical_Alerts
| eval slack_enabled=if('action.slack'=1, "ğŸŸ¢ ON", "ğŸ”´ OFF")
| eval last_run=strftime(strptime('next_scheduled_time', "%Y-%m-%dT%H:%M:%S"), "%Y-%m-%d %H:%M:%S")
| table title, slack_enabled, cron_schedule, last_run, description
| rename title as "Alert Name", slack_enabled as "Slack Status", cron_schedule as "Schedule", last_run as "Next Run", description as "Description"
          </query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>

  <!-- FMG Policy Install -->
  <row>
    <panel>
      <title>ğŸ“¦ FMG Policy Install</title>
      <table>
        <search>
          <query>
| rest /services/saved/searches/FMG_Policy_Install
| eval slack_enabled=if('action.slack'=1, "ğŸŸ¢ ON", "ğŸ”´ OFF")
| eval last_run=strftime(strptime('next_scheduled_time', "%Y-%m-%dT%H:%M:%S"), "%Y-%m-%d %H:%M:%S")
| table title, slack_enabled, cron_schedule, last_run, description
| rename title as "Alert Name", slack_enabled as "Slack Status", cron_schedule as "Schedule", last_run as "Next Run", description as "Description"
          </query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>

  <!-- FMG Policy CRUD -->
  <row>
    <panel>
      <title>âœï¸ FMG Policy CRUD</title>
      <table>
        <search>
          <query>
| rest /services/saved/searches/FMG_Policy_CRUD
| eval slack_enabled=if('action.slack'=1, "ğŸŸ¢ ON", "ğŸ”´ OFF")
| eval last_run=strftime(strptime('next_scheduled_time', "%Y-%m-%dT%H:%M:%S"), "%Y-%m-%d %H:%M:%S")
| table title, slack_enabled, cron_schedule, last_run, description
| rename title as "Alert Name", slack_enabled as "Slack Status", cron_schedule as "Schedule", last_run as "Next Run", description as "Description"
          </query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>

  <!-- FMG Object CRUD -->
  <row>
    <panel>
      <title>ğŸ”§ FMG Object CRUD</title>
      <table>
        <search>
          <query>
| rest /services/saved/searches/FMG_Object_CRUD
| eval slack_enabled=if('action.slack'=1, "ğŸŸ¢ ON", "ğŸ”´ OFF")
| eval last_run=strftime(strptime('next_scheduled_time', "%Y-%m-%dT%H:%M:%S"), "%Y-%m-%d %H:%M:%S")
| table title, slack_enabled, cron_schedule, last_run, description
| rename title as "Alert Name", slack_enabled as "Slack Status", cron_schedule as "Schedule", last_run as "Next Run", description as "Description"
          </query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>

  <!-- Security High Severity -->
  <row>
    <panel>
      <title>âš ï¸ Security High Events</title>
      <table>
        <search>
          <query>
| rest /services/saved/searches/Security_High_Severity
| eval slack_enabled=if('action.slack'=1, "ğŸŸ¢ ON", "ğŸ”´ OFF")
| eval last_run=strftime(strptime('next_scheduled_time', "%Y-%m-%dT%H:%M:%S"), "%Y-%m-%d %H:%M:%S")
| table title, slack_enabled, cron_schedule, last_run, description
| rename title as "Alert Name", slack_enabled as "Slack Status", cron_schedule as "Schedule", last_run as "Next Run", description as "Description"
          </query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>

  <!-- Summary Panel -->
  <row>
    <panel>
      <title>ğŸ“Š Overall Status Summary</title>
      <table>
        <search>
          <query>
| rest /services/saved/searches
| search title IN ("FAZ_Critical_Alerts","FMG_Policy_Install","FMG_Policy_CRUD","FMG_Object_CRUD","Security_High_Severity")
| eval slack_status=if('action.slack'=1, "ON", "OFF")
| stats count by slack_status
| eval status_label=if(slack_status="ON", "ğŸŸ¢ Enabled", "ğŸ”´ Disabled")
| table status_label, count
| rename status_label as "Status", count as "Count"
          </query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>

  <row>
    <panel>
      <html>
        <div style="padding: 15px; background: #fff3cd; border-radius: 6px; border-left: 4px solid #ffc107;">
          <h4 style="margin-top: 0;">ğŸ“‹ ì‚¬ìš© ë°©ë²• (Read-Only Dashboard)</h4>
          <ul style="line-height: 1.8;">
            <li><strong>ì¡°íšŒ ì „ìš©:</strong> ì´ ëŒ€ì‹œë³´ë“œëŠ” ì•Œë¦¼ ìƒíƒœë§Œ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤</li>
            <li><strong>ON/OFF ë³€ê²½:</strong> Settings â†’ Searches, reports, and alerts â†’ ì•Œë¦¼ ì„ íƒ â†’ Edit â†’ Actions â†’ Slack ì²´í¬ë°•ìŠ¤</li>
            <li><strong>í…ŒìŠ¤íŠ¸ ë°œì†¡:</strong> ì•Œë¦¼ í¸ì§‘ í™”ë©´ì—ì„œ "Trigger Actions" í´ë¦­</li>
            <li><strong>ìë™ ìƒˆë¡œê³ ì¹¨:</strong> ëŒ€ì‹œë³´ë“œëŠ” ì‹¤ì‹œê°„ìœ¼ë¡œ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤</li>
          </ul>
        </div>
      </html>
    </panel>
  </row>
</form>
