{
    "visualizations": {
        "viz_alert_list": {
            "type": "splunk.table",
            "options": {
                "columnFormat": {
                    "status": {
                        "data": "string"
                    }
                },
                "headerVisibility": "fixed"
            },
            "dataSources": {
                "primary": "ds_alert_list"
            },
            "title": "ì‚¬ìš© ê°€ëŠ¥í•œ ì•Œë¦¼ ìœ í˜•"
        },
        "viz_test_result": {
            "type": "splunk.table",
            "options": {
                "headerVisibility": "fixed"
            },
            "dataSources": {
                "primary": "ds_test_result"
            },
            "title": "í…ŒìŠ¤íŠ¸ ê²°ê³¼"
        },
        "viz_single_success": {
            "type": "splunk.singlevalue",
            "options": {
                "majorColor": "#53a051",
                "backgroundColor": "transparent"
            },
            "dataSources": {
                "primary": "ds_success_count"
            },
            "title": "ì„±ê³µ"
        },
        "viz_single_total": {
            "type": "splunk.singlevalue",
            "options": {
                "majorColor": "#006d9c",
                "backgroundColor": "transparent"
            },
            "dataSources": {
                "primary": "ds_total_count"
            },
            "title": "ì „ì²´ í…ŒìŠ¤íŠ¸"
        },
        "viz_webhook_status": {
            "type": "splunk.singlevalue",
            "options": {
                "majorColor": "#53a051",
                "backgroundColor": "transparent"
            },
            "dataSources": {
                "primary": "ds_webhook_status"
            },
            "title": "Webhook ìƒíƒœ"
        }
    },
    "dataSources": {
        "ds_alert_list": {
            "type": "ds.search",
            "options": {
                "query": "| makeresults | eval data=\"001,Config Change,âš™ï¸|002,VPN Tunnel Down,ğŸ”´|003,VPN Tunnel Up,ğŸŸ¢|006,CPU/Memory Anomaly,ğŸ“Š|007,Hardware Failure,ğŸ”´|008,HA State Change,ğŸ”„|010,Resource Limit,âš ï¸|011,Admin Login Failed,ğŸš«|012,Interface Down,ğŸ”´|013,SSL VPN Brute Force,ğŸš¨|015,Abnormal Traffic Spike,ğŸ“ˆ|016,System Reboot,ğŸ”„|017,License Expiry Warning,â°\" | makemv delim=\"|\" data | mvexpand data | rex field=data \"(?<alert_id>[^,]+),(?<alert_name>[^,]+),(?<emoji>.+)\" | table alert_id, emoji, alert_name | rename alert_id as \"ì•Œë¦¼ ID\", emoji as \"ì•„ì´ì½˜\", alert_name as \"ì•Œë¦¼ ìœ í˜•\"",
                "queryParameters": {
                    "earliest": "-1m",
                    "latest": "now"
                }
            }
        },
        "ds_test_result": {
            "type": "ds.search",
            "options": {
                "query": "| script sendtestalert $alert_type$ | rex field=_raw \"(?<status>[âœ“âœ—])\\s+(?<alert_id>\\d+):\\s+(?<result>.+)\" | table status, alert_id, result | rename status as \"ìƒíƒœ\", alert_id as \"ì•Œë¦¼ ID\", result as \"ê²°ê³¼\"",
                "queryParameters": {
                    "earliest": "-1m",
                    "latest": "now"
                }
            }
        },
        "ds_success_count": {
            "type": "ds.search",
            "options": {
                "query": "| script sendtestalert $alert_type$ | search \"âœ“\" | stats count as success",
                "queryParameters": {
                    "earliest": "-1m",
                    "latest": "now"
                }
            }
        },
        "ds_total_count": {
            "type": "ds.search",
            "options": {
                "query": "| script sendtestalert $alert_type$ | stats count as total",
                "queryParameters": {
                    "earliest": "-1m",
                    "latest": "now"
                }
            }
        },
        "ds_webhook_status": {
            "type": "ds.search",
            "options": {
                "query": "| makeresults | eval status=\"Connected âœ“\" | table status",
                "queryParameters": {
                    "earliest": "-1m",
                    "latest": "now"
                }
            }
        }
    },
    "inputs": {
        "input_alert_type": {
            "type": "input.dropdown",
            "options": {
                "items": [
                    {"label": "ì „ì²´ ì•Œë¦¼ í…ŒìŠ¤íŠ¸", "value": "all"},
                    {"label": "001 - Config Change", "value": "001"},
                    {"label": "002 - VPN Tunnel Down", "value": "002"},
                    {"label": "003 - VPN Tunnel Up", "value": "003"},
                    {"label": "006 - CPU/Memory Anomaly", "value": "006"},
                    {"label": "007 - Hardware Failure", "value": "007"},
                    {"label": "008 - HA State Change", "value": "008"},
                    {"label": "010 - Resource Limit", "value": "010"},
                    {"label": "011 - Admin Login Failed", "value": "011"},
                    {"label": "012 - Interface Down", "value": "012"},
                    {"label": "013 - SSL VPN Brute Force", "value": "013"},
                    {"label": "015 - Abnormal Traffic Spike", "value": "015"},
                    {"label": "016 - System Reboot", "value": "016"},
                    {"label": "017 - License Expiry Warning", "value": "017"}
                ],
                "defaultValue": "all",
                "token": "alert_type"
            },
            "title": "ì•Œë¦¼ ìœ í˜• ì„ íƒ"
        },
        "input_submit": {
            "type": "input.submit",
            "options": {},
            "title": "í…ŒìŠ¤íŠ¸ ì‹¤í–‰"
        }
    },
    "layout": {
        "type": "grid",
        "globalInputs": ["input_alert_type", "input_submit"],
        "structure": [
            {
                "item": "viz_webhook_status",
                "position": {"x": 0, "y": 0, "w": 300, "h": 100}
            },
            {
                "item": "viz_single_success",
                "position": {"x": 300, "y": 0, "w": 300, "h": 100}
            },
            {
                "item": "viz_single_total",
                "position": {"x": 600, "y": 0, "w": 300, "h": 100}
            },
            {
                "item": "viz_alert_list",
                "position": {"x": 0, "y": 100, "w": 600, "h": 400}
            },
            {
                "item": "viz_test_result",
                "position": {"x": 600, "y": 100, "w": 600, "h": 400}
            }
        ]
    },
    "title": "Slack ì•Œë¦¼ í…ŒìŠ¤íŠ¸",
    "description": "FortiGate ì•Œë¦¼ ìœ í˜•ë³„ Slack ë©”ì‹œì§€ í…ŒìŠ¤íŠ¸ ëŒ€ì‹œë³´ë“œ",
    "defaults": {
        "dataSources": {
            "ds.search": {
                "options": {
                    "queryParameters": {
                        "earliest": "-1m",
                        "latest": "now"
                    }
                }
            }
        }
    }
}
