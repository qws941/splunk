<form version="1.1">
  <label>Slack Alert Test</label>
  <description>Simple Slack integration test - Send test alerts and verify delivery</description>

  <!-- Row 1: ì•ˆë‚´ -->
  <row>
    <panel>
      <html>
        <div style="padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px; color: white;">
          <h2 style="margin-top: 0;">ğŸ”” Slack ì•Œë¦¼ í…ŒìŠ¤íŠ¸</h2>
          <p style="font-size: 16px;">
            ì•„ë˜ "í…ŒìŠ¤íŠ¸ ì‹¤í–‰" ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ <strong>1ê°œì˜ í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€</strong>ê°€ Slackìœ¼ë¡œ ì „ì†¡ë©ë‹ˆë‹¤.
          </p>
          <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 5px; margin-top: 15px;">
            <h3 style="margin-top: 0;">âš™ï¸ ì„¤ì • ìœ„ì¹˜</h3>
            <ul style="font-size: 14px; list-style: none; padding: 0;">
              <li>âœ“ Settings â†’ Alert actions â†’ Slack</li>
              <li>âœ“ Token: Bot User OAuth Token (xoxb-<example>)</li>
              <li>âœ“ Channel: #splunk-alerts</li>
            </ul>
          </div>
        </div>
      </html>
    </panel>
  </row>

  <!-- Row 2: í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë²„íŠ¼ -->
  <row>
    <panel>
      <title>ğŸš€ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</title>
      <table>
        <search>
          <query>| makeresults count=1
| eval test_message="ğŸ‰ Slack í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€",
       test_time=strftime(now(), "%Y-%m-%d %H:%M:%S"),
       severity="info",
       source="Splunk Dashboard Test"
| table test_time, test_message, severity, source
| sendalert slack param.channel="splunk-alerts" param.message=test_message</query>
          <earliest>-5m</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>

  <!-- Row 3: ìƒíƒœ í™•ì¸ -->
  <row>
    <panel>
      <title>ğŸ“Š ìµœê·¼ ì•Œë¦¼ ì´ë ¥ (24ì‹œê°„)</title>
      <table>
        <search>
          <query>index=_internal source=*scheduler.log action=alert_fired
| search alert_actions=*slack*
| eval alert_time=strftime(_time, "%Y-%m-%d %H:%M:%S")
| table alert_time, savedsearch_name, alert_actions, app
| head 10</query>
          <earliest>-24h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="count">10</option>
      </table>
    </panel>

    <panel>
      <title>âœ… Slack Plugin ì„¤ì • í™•ì¸</title>
      <html>
        <div style="padding: 15px; background: #f5f5f5; border-left: 4px solid #4CAF50; border-radius: 4px;">
          <h3 style="margin-top: 0; color: #333;">ì„¤ì • í™•ì¸ ë°©ë²•</h3>
          <ol style="color: #666; line-height: 1.8;">
            <li><strong>Settings</strong> â†’ <strong>Alert actions</strong></li>
            <li><strong>Slack</strong> í´ë¦­</li>
            <li><strong>Token</strong> í™•ì¸ (xoxb-ë¡œ ì‹œì‘í•´ì•¼ í•¨)</li>
            <li><strong>Channel</strong> í™•ì¸ (#splunk-alerts)</li>
            <li><strong>Enable</strong> ì²´í¬ë¨ í™•ì¸</li>
          </ol>

          <div style="margin-top: 15px; padding: 10px; background: #fff3cd; border-left: 3px solid #ffc107; border-radius: 3px;">
            <strong>âš ï¸ ì£¼ì˜:</strong> Botì„ Slack ì±„ë„ì— ì´ˆëŒ€í•´ì•¼ í•©ë‹ˆë‹¤.<br/>
            <code>/invite @Splunk FortiGate Alert</code>
          </div>
        </div>
      </html>
    </panel>
  </row>

  <!-- Row 4: ê³ ê¸‰ í…ŒìŠ¤íŠ¸ (ìƒì„¸ ì •ë³´ í¬í•¨) -->
  <row>
    <panel>
      <title>ğŸ”§ ê³ ê¸‰ í…ŒìŠ¤íŠ¸ (ìƒì„¸ ì •ë³´ í¬í•¨)</title>
      <table>
        <search>
          <query>| makeresults count=1
| eval src_ip="192.168.100.99",
       dst_ip="10.0.0.50",
       severity="high",
       attack="Test Alert - SSH Brute Force",
       event_count=1,
       test_time=strftime(now(), "%Y-%m-%d %H:%M:%S KST"),
       message="ğŸš¨ FortiGate Security Alert - TEST\n\n*Source IP:* " + src_ip + "\n*Destination IP:* " + dst_ip + "\n*Severity:* " + severity + "\n*Attack Type:* " + attack + "\n*Time:* " + test_time
| table src_ip, dst_ip, severity, attack, test_time
| sendalert slack param.channel="splunk-alerts" param.message=message</query>
          <earliest>-5m</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
</form>
