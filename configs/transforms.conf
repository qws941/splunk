# Splunk Transforms Configuration
# Location: $SPLUNK_HOME/etc/apps/fortigate/local/transforms.conf
#
# Purpose: Define lookup tables for threat intelligence enrichment

# ============================================================================
# AbuseIPDB Threat Intelligence Lookup
# ============================================================================
# CSV Format: ip,abuse_score,country,isp,domain,last_reported
# Update: Hourly via scripts/fetch_abuseipdb_intel.py

[abuseipdb_lookup]
filename = abuseipdb_lookup.csv
case_sensitive_match = false
# Match on source IP
match_type = CIDR(ip)
# Output fields
min_matches = 1
max_matches = 1

# Field definitions
fields_list = ip,abuse_score,country,isp,domain,last_reported,total_reports,distinct_users

# ============================================================================
# VirusTotal Threat Intelligence Lookup
# ============================================================================
# CSV Format: ip,vt_score,malicious_votes,suspicious_votes,harmless_votes

[virustotal_lookup]
filename = virustotal_lookup.csv
case_sensitive_match = false
match_type = CIDR(ip)
min_matches = 1
max_matches = 1

fields_list = ip,vt_score,malicious_votes,suspicious_votes,harmless_votes,last_analysis_date

# ============================================================================
# FortiGate Blocked IPs Lookup
# ============================================================================
# CSV Format: src_ip,blocked_time,correlation_score,block_reason,blocked_by

[fortigate_blocked_ips]
filename = fortigate_blocked_ips.csv
case_sensitive_match = false

# ============================================================================
# FortiGate Whitelist Lookup
# ============================================================================
# CSV Format: ip,whitelist_reason,added_by,added_time

[fortigate_whitelist]
filename = fortigate_whitelist.csv
case_sensitive_match = false

# ============================================================================
# Geo-Location Risk Scoring
# ============================================================================
# CSV Format: country,country_name,geo_risk_score,risk_category

[geo_risk_lookup]
filename = geo_risk_lookup.csv
case_sensitive_match = false

fields_list = country,country_name,geo_risk_score,risk_category,notes

# ============================================================================
# Attack Type Taxonomy
# ============================================================================
# CSV Format: attack_id,attack_name,category,severity,auto_block_eligible

[attack_taxonomy]
filename = attack_taxonomy.csv
case_sensitive_match = false

fields_list = attack_id,attack_name,category,severity,auto_block_eligible,description

# ============================================================================
# Slack Alert Toggle State
# ============================================================================
# CSV Format: alert_name,enabled,updated_by,updated_time

[slack_alert_toggle]
filename = slack_alert_toggle.csv
case_sensitive_match = false

fields_list = alert_name,enabled,updated_by,updated_time
