```spl
# 9. Resource Usage Monitoring (리소스 사용률 모니터링)
# 목적: CPU, Memory, Disk, Session 사용률 추적
# 실행: Splunk 검색창에 붙여넣기

index=fortianalyzer earliest=-24h type=event subtype=system \
    (logid=0104032* OR msg="*cpu*" OR msg="*memory*" OR msg="*disk*" OR msg="*session*") \
| eval resource_type = case(
    match(msg, "(?i)cpu"), "CPU",
    match(msg, "(?i)memory"), "Memory",
    match(msg, "(?i)disk"), "Disk",
    match(msg, "(?i)session"), "Session",
    1=1, "Other") \
| eval severity = case(
    match(msg, "(?i)critical|full|exceeded"), "critical",
    match(msg, "(?i)high|warning"), "warning",
    1=1, "info") \
| eval device = devname \
| eval usage_value = coalesce(cpu_usage, mem_usage, disk_usage, session_count, "N/A") \
| eval description = coalesce(msg, logdesc, "No details") \
| table _time, device, resource_type, severity, usage_value, description \
| sort -_time \
| head 50
```

**확인할 것**:
- CPU 사용률이 90% 이상인가?
- Memory 부족 경고가 있는가?
- Disk full 이벤트가 있는가?
- Session table이 full인가?

**주요 Resource LogID**:
- 0104032000: CPU usage high
- 0104032001: Memory usage high
- 0104032002: Disk usage high
- 0104032003: Session table full
- 0104032004: Log disk full
- 0104032005: System resources critical

**Alert 조건 제안**:
- CPU > 90% for 5 minutes (과부하)
- Memory > 90% (메모리 부족)
- Disk > 95% (디스크 full 임박)
- Session table > 90% (세션 고갈)

**추세 분석 쿼리**:
```spl
index=fortianalyzer earliest=-7d type=event subtype=system logid=0104032* \
| eval cpu = coalesce(cpu_usage, 0) \
| eval mem = coalesce(mem_usage, 0) \
| timechart span=1h avg(cpu) as avg_cpu, avg(mem) as avg_memory by devname
```
```
