```spl
# 7. Interface Status Monitoring (인터페이스 상태 모니터링)
# 목적: 인터페이스 Up/Down, Link 변경 감지
# 실행: Splunk 검색창에 붙여넣기

index=fortianalyzer earliest=-24h type=event subtype=system \
    (logid=0104043* OR msg="*interface*" OR msg="*link*") \
| eval interface_name = coalesce(interface, "N/A") \
| eval event_type = case(
    match(msg, "(?i)link up"), "Link Up",
    match(msg, "(?i)link down"), "Link Down",
    match(msg, "(?i)interface.*up"), "Interface Up",
    match(msg, "(?i)interface.*down"), "Interface Down",
    match(msg, "(?i)carrier"), "Carrier Change",
    1=1, "Other Interface Event") \
| eval device = devname \
| eval severity = case(
    match(event_type, "Down"), "critical",
    match(event_type, "Up"), "info",
    1=1, "warning") \
| eval description = coalesce(msg, logdesc, "No details") \
| table _time, device, interface_name, event_type, severity, description \
| sort -_time \
| head 50
```

**확인할 것**:
- 인터페이스가 자주 Down되는가? (케이블/하드웨어 문제)
- 특정 시간대에 Down이 집중되는가?
- WAN/LAN 인터페이스 중 어디가 불안정한가?
- Down 후 Up까지 걸린 시간은?

**주요 Interface LogID**:
- 0104043521: Link up detected
- 0104043522: Link down detected
- 0104043514: Interface status change
- 0104043004: Physical interface down
- 0104043005: Physical interface up

**Alert 조건 제안**:
- Link down on WAN interface (인터넷 단절)
- Link flapping (5분 내 3회 이상 up/down)
- Critical interface down > 5 minutes
```
