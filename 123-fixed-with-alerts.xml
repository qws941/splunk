<form version="1.1" theme="dark">
  <label>[security]main_dashboard_v1_fixed</label>
  <fieldset submitButton="true" autoRun="true">
    <input type="time" token="time_picker" searchWhenChanged="true">
      <label>ì‹œê°„ ë²”ìœ„</label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="dropdown" token="device_type" searchWhenChanged="true">
      <label>ì¥ë¹„ ìœ í˜•</label>
      <choice value="*">ì „ì²´</choice>
      <choice value="FortiGate*">FortiGate</choice>
      <choice value="FortiManager*">FortiManager</choice>
      <choice value="FortiAnalyzer*">FortiAnalyzer</choice>
      <default>*</default>
    </input>
    <input type="dropdown" token="action_filter" searchWhenChanged="true">
      <label>ë°©í™”ë²½ ë™ì‘</label>
      <choice value="*">ì „ì²´</choice>
      <choice value="accept">í—ˆìš©</choice>
      <choice value="deny">ì°¨ë‹¨</choice>
      <choice value="drop">ë“œë¡­</choice>
      <default>*</default>
    </input>
  </fieldset>

  <!-- Row 1: ë°©í™”ë²½ ìš´ì˜ í˜„í™© -->
  <row>
    <panel>
      <single>
        <title>ì „ì²´ íŠ¸ë˜í”½</title>
        <search>
          <query>
            index=fw type="traffic" devname=$device_type$
            | stats count
          </query>
          <earliest>$time_picker.earliest$</earliest>
          <latest>$time_picker.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="useThousandSeparators">1</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>í—ˆìš© íŠ¸ë˜í”½</title>
        <search>
          <query>
            index=fw type="traffic" action="accept" devname=$device_type$
            | stats count
          </query>
          <earliest>$time_picker.earliest$</earliest>
          <latest>$time_picker.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="colorBy">value</option>
        <option name="colorMode">block</option>
        <option name="rangeColors">["0x53A051"]</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>ì°¨ë‹¨ íŠ¸ë˜í”½</title>
        <search>
          <query>
            index=fw type="traffic" (action="deny" OR action="drop" OR action="blocked") devname=$device_type$
            | stats count
          </query>
          <earliest>$time_picker.earliest$</earliest>
          <latest>$time_picker.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="colorBy">value</option>
        <option name="colorMode">block</option>
        <option name="rangeColors">["0xDC4E41"]</option>
        <option name="useColors">1</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>í™œì„± ì •ì±… ìˆ˜</title>
        <search>
          <query>
            index=fw type="traffic" policyid=* devname=$device_type$
            | stats dc(policyid) as policies
          </query>
          <earliest>$time_picker.earliest$</earliest>
          <latest>$time_picker.latest$</latest>
        </search>
        <option name="drilldown">none</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>ì°¨ë‹¨ìœ¨ (%)</title>
        <search>
          <query>
            index=fw type="traffic" devname=$device_type$
            | eval blocked = if(action="deny" OR action="drop", 1, 0)
            | stats sum(blocked) as blocked_count, count as total
            | eval percentage = round((blocked_count/total)*100, 2)
            | fields percentage
          </query>
          <earliest>$time_picker.earliest$</earliest>
          <latest>$time_picker.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">2</option>
        <option name="unit">%</option>
        <option name="colorBy">value</option>
        <option name="rangeColors">["0x53A051","0xF8BE34","0xDC4E41"]</option>
        <option name="rangeValues">[0,10,30]</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>

  <!-- Row 2: ë°©í™”ë²½ ì •ì±… ë¶„ì„ -->
  <row>
    <panel span="12">
      <title>ë°©í™”ë²½ ì •ì±… ì‚¬ìš© í˜„í™©</title>
      <table>
        <search>
          <query>
            index=fw type="traffic" policyid=* action=$action_filter$ devname=$device_type$
            | stats count as hits,
                    sum(sentbyte) as sent,
                    sum(rcvdbyte) as rcvd,
                    dc(srcip) as src_count,
                    dc(dstip) as dst_count,
                    values(action) as actions,
                    values(devname) as devices by policyid, policyname
            | eval total_gb = round((sent+rcvd)/1073741824, 2)
            | sort -hits
            | head 30
            | rename policyid AS "ì •ì±…ID",
                     policyname AS "ì •ì±…ëª…",
                     hits AS "ë§¤ì¹­íšŸìˆ˜",
                     total_gb AS "íŠ¸ë˜í”½(GB)",
                     src_count AS "ì†ŒìŠ¤IPìˆ˜",
                     dst_count AS "ëª©ì ì§€IPìˆ˜",
                     actions AS "ë™ì‘",
                     devices AS "ì¥ë¹„"
          </query>
          <earliest>$time_picker.earliest$</earliest>
          <latest>$time_picker.latest$</latest>
        </search>
        <option name="count">30</option>
        <option name="drilldown">cell</option>
        <option name="wrap">true</option>
        <format type="color" field="ë™ì‘">
          <colorPalette type="map">{"accept":#53A051,"deny":#DC4E41,"drop":#F8BE34}</colorPalette>
        </format>
      </table>
    </panel>
  </row>

  <!-- Row 3: ë°©í™”ë²½ ì •ì±… ë³€ê²½ ì´ë ¥ -->
  <row>
    <panel span="12">
      <title>ë°©í™”ë²½ ì •ì±… ë³€ê²½ ì´ë ¥ (FMG/FAZ ì¤‘ë³µì œê±°)</title>
      <table>
        <search>
          <query>
            index=fw (cfgpath="firewall.policy" OR cfgpath="firewall.rule" OR logid="0100044547" OR logid="0100044546")
            | rex field=_raw "cfgobj=\"(?&lt;policy_obj&gt;[^\"]+)\""
            | rex field=_raw "cfgattr=\"(?&lt;policy_attr&gt;[^\"]+)\""
            | rex field=ui "(?&lt;access&gt;\w+)\((?&lt;ip&gt;[^\)]+)\)"

            | eval config_hash = md5(cfgpath . policy_obj . policy_attr . user . _time)
            | stats first(_time) as _time, first(devname) as devname, first(user) as user, first(action) as action, first(policy_obj) as policy_obj, first(policy_attr) as policy_attr, first(access) as access, first(ip) as ip by config_hash

            | eval timestamp = strftime(_time, "%Y-%m-%d %H:%M:%S")
            | eval mgmt_source = case(
                match(devname, "FMG|FortiManager"), "FortiManager",
                match(devname, "FAZ|FortiAnalyzer"), "FortiAnalyzer",
                match(devname, "FG|FortiGate"), "FortiGate",
                1=1, devname)

            | rex field=policy_attr "srcintf\[(?&lt;src_intf&gt;[^\]]+)\]"
            | rex field=policy_attr "dstintf\[(?&lt;dst_intf&gt;[^\]]+)\]"
            | rex field=policy_attr "srcaddr\[(?&lt;src_addr&gt;[^\]]+)\]"
            | rex field=policy_attr "dstaddr\[(?&lt;dst_addr&gt;[^\]]+)\]"
            | rex field=policy_attr "service\[(?&lt;service&gt;[^\]]+)\]"
            | rex field=policy_attr "action\[(?&lt;fw_action&gt;[^\]]+)\]"

            | eval change_detail = case(
                isnotnull(src_intf), "ì†ŒìŠ¤ì¸í„°í˜ì´ìŠ¤: " + src_intf,
                isnotnull(dst_intf), "ëª©ì ì§€ì¸í„°í˜ì´ìŠ¤: " + dst_intf,
                isnotnull(src_addr), "ì†ŒìŠ¤ì£¼ì†Œ: " + src_addr,
                isnotnull(dst_addr), "ëª©ì ì§€ì£¼ì†Œ: " + dst_addr,
                isnotnull(service), "ì„œë¹„ìŠ¤: " + service,
                isnotnull(fw_action), "ë™ì‘: " + fw_action,
                isnotnull(policy_attr), policy_attr,
                1=1, "-")

            | table timestamp, mgmt_source, user, action, policy_obj, change_detail, access, ip
            | rename timestamp AS "ì‹œê°„",
                     mgmt_source AS "ê´€ë¦¬ì‹œìŠ¤í…œ",
                     user AS "ê´€ë¦¬ì",
                     action AS "ì‘ì—…",
                     policy_obj AS "ì •ì±…ê°ì²´",
                     change_detail AS "ë³€ê²½ë‚´ìš©",
                     access AS "ì ‘ì†ë°©ë²•",
                     ip AS "ì ‘ì†IP"
            | sort -ì‹œê°„
            | head 20
          </query>
          <earliest>$time_picker.earliest$</earliest>
          <latest>$time_picker.latest$</latest>
        </search>
        <option name="count">20</option>
        <option name="drilldown">cell</option>
        <option name="wrap">true</option>
        <format type="color" field="ê´€ë¦¬ì‹œìŠ¤í…œ">
          <colorPalette type="map">{"FortiManager":#4ECDC4,"FortiAnalyzer":#45B7D1,"FortiGate":#96CEB4}</colorPalette>
        </format>
        <format type="color" field="ì‘ì—…">
          <colorPalette type="map">{"Delete":#DC4E41,"Add":#53A051,"Edit":#F8BE34,"Set":#87CEEB}</colorPalette>
        </format>
      </table>
    </panel>
  </row>


    <!-- Row 4: ê°ì²´ ë³€ê²½ ë¡œê·¸ (ì„¤ì • ë³€ê²½) -->
  <row>
    <panel span="6">
      <title>ğŸ“ ì£¼ì†Œ ê°ì²´ ë³€ê²½ (ì„¤ì • ë³€ê²½ ë¡œê·¸)</title>
      <table>
        <search>
          <query>
index=fw earliest=-7d (cfgpath="firewall.address" OR cfgpath="firewall.addrgrp" OR logid="0100044547" OR logid="0100044546")
| rex field=_raw "cfgobj=\"(?&lt;config_object&gt;[^\"]+)\""
| rex field=_raw "cfgattr=\"(?&lt;config_attr&gt;[^\"]+)\""
| eval object_name = coalesce(config_object, "Unknown")
| eval change_detail = case(
    isnotnull(config_attr) AND len(config_attr) &lt; 100, config_attr,
    isnotnull(cfgpath), cfgpath,
    1=1, "ì„¤ì • ë³€ê²½")
| eval change_user = coalesce(user, "system")
| eval change_action = coalesce(action, "modify")
| eval timestamp = strftime(_time, "%Y-%m-%d %H:%M:%S")
| eval source = case(
    match(devname, "FMG"), "FMG",
    match(devname, "FAZ"), "FAZ",
    1=1, "FG")
| table timestamp, source, change_user, change_action, object_name, change_detail, devname
| rename timestamp AS "ì‹œê°„",
         source AS "ì‹œìŠ¤í…œ",
         change_user AS "ê´€ë¦¬ì",
         change_action AS "ì‘ì—…",
         object_name AS "ê°ì²´ëª…",
         change_detail AS "ë³€ê²½ë‚´ìš©",
         devname AS "ì¥ë¹„"
| sort -ì‹œê°„
| head 30
          </query>
          <earliest>-7d@d</earliest>
          <latest>now</latest>
          <refresh>5m</refresh>
        </search>
        <option name="count">30</option>
        <option name="wrap">true</option>
        <option name="drilldown">none</option>
      </table>
    </panel>
    <panel span="6">
      <title>ğŸ”§ ì„œë¹„ìŠ¤ ê°ì²´ ë³€ê²½ (í¬íŠ¸/í”„ë¡œí† ì½œ)</title>
      <table>
        <search>
          <query>
index=fw earliest=-7d (cfgpath="firewall.service.custom" OR cfgpath="firewall.service.group")
| rex field=_raw "cfgobj=\"(?&lt;config_object&gt;[^\"]+)\""
| rex field=_raw "cfgattr=\"(?&lt;config_attr&gt;[^\"]+)\""
| rex field=config_attr "tcp-portrange\[(?&lt;tcp_port&gt;[^\]]+)\]"
| rex field=config_attr "udp-portrange\[(?&lt;udp_port&gt;[^\]]+)\]"
| rex field=config_attr "protocol\[(?&lt;protocol&gt;[^\]]+)\]"
| eval object_name = coalesce(config_object, "Unknown")
| eval port_info = case(
    isnotnull(tcp_port), "TCP: " + tcp_port,
    isnotnull(udp_port), "UDP: " + udp_port,
    isnotnull(protocol), "Proto: " + protocol,
    1=1, "-")
| eval change_detail = if(len(config_attr) &lt; 100, config_attr, port_info)
| eval change_user = coalesce(user, "system")
| eval change_action = coalesce(action, "modify")
| eval timestamp = strftime(_time, "%Y-%m-%d %H:%M:%S")
| eval source = case(
    match(devname, "FMG"), "FMG",
    match(devname, "FAZ"), "FAZ",
    1=1, "FG")
| table timestamp, source, change_user, change_action, object_name, port_info, devname
| rename timestamp AS "ì‹œê°„",
         source AS "ì‹œìŠ¤í…œ",
         change_user AS "ê´€ë¦¬ì",
         change_action AS "ì‘ì—…",
         object_name AS "ì„œë¹„ìŠ¤ëª…",
         port_info AS "í¬íŠ¸ì •ë³´",
         devname AS "ì¥ë¹„"
| sort -ì‹œê°„
| head 30
          </query>
          <earliest>-7d@d</earliest>
          <latest>now</latest>
          <refresh>5m</refresh>
        </search>
        <option name="count">30</option>
        <option name="wrap">true</option>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>

  <!-- Row 5: ì°¨ë‹¨ íŠ¸ë˜í”½ ë¶„ì„ -->
  <row>
    <panel>
      <title>ğŸš« ì°¨ë‹¨ëœ íŠ¸ë˜í”½ ìƒì„¸ (ì‹¤ì‹œê°„)</title>
      <table>
        <search>
          <query>
index=fw type="traffic" (action="deny" OR action="drop" OR action="blocked")
| eval timestamp = strftime(_time, "%Y-%m-%d %H:%M:%S")
| rex field=msg "(?i)policy\s*check\s*failed"
| rex field=msg "(?i)deny\s+by\s+(?&lt;deny_reason&gt;[^,]+)"
| eval block_reason = case(
    match(msg, "(?i)policy.*denied"), "ì •ì±… ê±°ë¶€",
    match(msg, "(?i)policy.*check.*failed"), "ì •ì±… ê²€ì¦ ì‹¤íŒ¨",
    isnotnull(deny_reason), deny_reason,
    match(msg, "(?i)invalid"), "ìœ íš¨í•˜ì§€ ì•Šì€ íŒ¨í‚·",
    match(msg, "(?i)spoofing"), "IP ìŠ¤í‘¸í•‘",
    match(msg, "(?i)blacklist"), "ë¸”ë™ë¦¬ìŠ¤íŠ¸",
    match(msg, "(?i)dos"), "DoS ê³µê²©",
    match(msg, "(?i)scan"), "í¬íŠ¸ ìŠ¤ìº”",
    policyid=0, "ì •ì±… ì—†ìŒ (ê¸°ë³¸ ê±°ë¶€)",
    1=1, "ê¸°íƒ€")
| eval service_display = coalesce(service, dstport)
| table timestamp, srcip, srcport, dstip, dstport, service_display, policyid, block_reason, devname
| rename timestamp AS "ì‹œê°„",
         srcip AS "ì¶œë°œì§€IP",
         srcport AS "ì¶œë°œì§€í¬íŠ¸",
         dstip AS "ëª©ì ì§€IP",
         dstport AS "ëª©ì ì§€í¬íŠ¸",
         service_display AS "ì„œë¹„ìŠ¤",
         policyid AS "ì •ì±…ID",
         block_reason AS "ì°¨ë‹¨ì‚¬ìœ ",
         devname AS "ì¥ë¹„"
| sort -ì‹œê°„
| head 30
          </query>
          <earliest>$time_picker.earliest$</earliest>
          <latest>$time_picker.latest$</latest>
          <refresh>30s</refresh>
        </search>
        <option name="count">30</option>
        <option name="drilldown">cell</option>
        <option name="wrap">true</option>
        <format type="color" field="ì°¨ë‹¨ì‚¬ìœ ">
          <colorPalette type="map">{"ì •ì±… ê±°ë¶€":#DC4E41,"ì •ì±… ê²€ì¦ ì‹¤íŒ¨":#DC4E41,"ì •ì±… ì—†ìŒ (ê¸°ë³¸ ê±°ë¶€)":#8B0000,"ìœ íš¨í•˜ì§€ ì•Šì€ íŒ¨í‚·":#F8BE34,"IP ìŠ¤í‘¸í•‘":#FF6B6B,"ë¸”ë™ë¦¬ìŠ¤íŠ¸":#8B0000,"DoS ê³µê²©":#FF0000,"í¬íŠ¸ ìŠ¤ìº”":#FFA500}</colorPalette>
        </format>
      </table>
    </panel>
  </row>

  <!-- Row 6: ì¸í„°í˜ì´ìŠ¤ë³„ íŠ¸ë˜í”½ -->
  <row>
    <panel span="6">
      <title>ì¸í„°í˜ì´ìŠ¤ë³„ In/Out íŠ¸ë˜í”½</title>
      <chart>
        <search>
          <query>
            index=fw type="traffic" devname=$device_type$
            | eval in_mb = rcvdbyte/1048576
            | eval out_mb = sentbyte/1048576
            | stats sum(in_mb) as "ìˆ˜ì‹ (MB)", sum(out_mb) as "ì†¡ì‹ (MB)" by srcintf
            | sort -"ìˆ˜ì‹ (MB)"
            | head 10
          </query>
          <earliest>$time_picker.earliest$</earliest>
          <latest>$time_picker.latest$</latest>
        </search>
        <option name="charting.chart">column</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.axisTitleY.text">íŠ¸ë˜í”½ (MB)</option>
        <option name="charting.axisTitleX.text">ì¸í„°í˜ì´ìŠ¤</option>
        <option name="charting.legend.placement">bottom</option>
      </chart>
    </panel>
    <panel span="6">
      <title>ì‹œê°„ëŒ€ë³„ í—ˆìš©/ì°¨ë‹¨ ì¶”ì´</title>
      <chart>
        <search>
          <query>
            index=fw type="traffic" devname=$device_type$
            | eval action_type = case(
                action="accept", "í—ˆìš©",
                action="deny" OR action="drop", "ì°¨ë‹¨",
                1=1, "ê¸°íƒ€")
            | timechart span=1h count by action_type
          </query>
          <earliest>$time_picker.earliest$</earliest>
          <latest>$time_picker.latest$</latest>
        </search>
        <option name="charting.chart">area</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.fieldColors">{"í—ˆìš©":"#53A051","ì°¨ë‹¨":"#DC4E41","ê¸°íƒ€":"#F8BE34"}</option>
        <option name="charting.axisTitleY.text">íŠ¸ë˜í”½ ìˆ˜</option>
        <option name="charting.axisTitleX.text">ì‹œê°„</option>
      </chart>
    </panel>
  </row>

  <!-- Row 7: Top í†µì‹  í˜„í™© -->
  <row>
    <panel span="4">
      <title>Top 10 ì¶œë°œì§€ IP</title>
      <table>
        <search>
          <query>
            index=fw type="traffic" action=$action_filter$ devname=$device_type$
            | stats count as connections,
                    sum(sentbyte) as sent,
                    dc(dstip) as destinations by srcip
            | eval sent_gb = round(sent/1073741824, 2)
            | sort -connections
            | head 10
            | rename srcip AS "ì¶œë°œì§€IP",
                     connections AS "ì—°ê²°ìˆ˜",
                     sent_gb AS "ì†¡ì‹ (GB)",
                     destinations AS "ëª©ì ì§€ìˆ˜"
          </query>
          <earliest>$time_picker.earliest$</earliest>
          <latest>$time_picker.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">cell</option>
      </table>
    </panel>
    <panel span="4">
      <title>Top 10 ëª©ì ì§€ IP</title>
      <table>
        <search>
          <query>
            index=fw type="traffic" action=$action_filter$ devname=$device_type$
            | stats count as connections,
                    sum(rcvdbyte) as received,
                    dc(srcip) as sources by dstip
            | eval received_gb = round(received/1073741824, 2)
            | sort -connections
            | head 10
            | rename dstip AS "ëª©ì ì§€IP",
                     connections AS "ì—°ê²°ìˆ˜",
                     received_gb AS "ìˆ˜ì‹ (GB)",
                     sources AS "ì¶œë°œì§€ìˆ˜"
          </query>
          <earliest>$time_picker.earliest$</earliest>
          <latest>$time_picker.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">cell</option>
      </table>
    </panel>
    <panel span="4">
      <title>Top 10 ì„œë¹„ìŠ¤/í¬íŠ¸</title>
      <table>
        <search>
          <query>
            index=fw type="traffic" action=$action_filter$ devname=$device_type$
            | eval port_service = service + " (" + dstport + ")"
            | stats count as hits,
                    dc(srcip) as unique_src,
                    dc(dstip) as unique_dst by port_service
            | sort -hits
            | head 10
            | rename port_service AS "ì„œë¹„ìŠ¤(í¬íŠ¸)",
                     hits AS "ì‚¬ìš©íšŸìˆ˜",
                     unique_src AS "ì†ŒìŠ¤ìˆ˜",
                     unique_dst AS "ëª©ì ì§€ìˆ˜"
          </query>
          <earliest>$time_picker.earliest$</earliest>
          <latest>$time_picker.latest$</latest>
        </search>
        <option name="count">10</option>
      </table>
    </panel>
  </row>

  <!-- Row 8: ì‹¤ì‹œê°„ ë°©í™”ë²½ ì´ë²¤íŠ¸ -->
  <row>
    <panel span="12">
      <title>ì‹¤ì‹œê°„ ë°©í™”ë²½ ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¼</title>
      <table>
        <search>
          <query>
            index=fw devname=$device_type$
            | eval timestamp = strftime(_time, "%H:%M:%S")
            | eval system = case(
                match(devname, "FMG"), "FMG",
                match(devname, "FAZ"), "FAZ",
                match(devname, "FG"), "FG",
                1=1, "ê¸°íƒ€")
            | eval event_type = case(
                type="traffic" AND action="deny", "íŠ¸ë˜í”½ì°¨ë‹¨",
                type="traffic" AND action="accept", "íŠ¸ë˜í”½í—ˆìš©",
                match(_raw, "policy"), "ì •ì±…ë³€ê²½",
                match(_raw, "login|logout"), "ê´€ë¦¬ìì¸ì¦",
                match(_raw, "critical"), "Critical",
                1=1, "ì‹œìŠ¤í…œ")
            | head 30
            | table timestamp, system, event_type, srcip, dstip, dstport, action, policyid, msg
            | rename timestamp AS "ì‹œê°„",
                     system AS "ì‹œìŠ¤í…œ",
                     event_type AS "ì´ë²¤íŠ¸",
                     srcip AS "ì¶œë°œì§€",
                     dstip AS "ëª©ì ì§€",
                     dstport AS "í¬íŠ¸",
                     action AS "ë™ì‘",
                     policyid AS "ì •ì±…",
                     msg AS "ë©”ì‹œì§€"
          </query>
          <earliest>-5m</earliest>
          <latest>now</latest>
          <refresh>10s</refresh>
        </search>
        <option name="count">30</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="ì´ë²¤íŠ¸">
          <colorPalette type="map">{"íŠ¸ë˜í”½ì°¨ë‹¨":#DC4E41,"íŠ¸ë˜í”½í—ˆìš©":#53A051,"ì •ì±…ë³€ê²½":#F8BE34,"Critical":#FF0000,"ê´€ë¦¬ìì¸ì¦":#87CEEB}</colorPalette>
        </format>
        <format type="color" field="ì‹œìŠ¤í…œ">
          <colorPalette type="map">{"FG":#4ECDC4,"FMG":#45B7D1,"FAZ":#96CEB4}</colorPalette>
        </format>
      </table>
    </panel>
  </row>
  <!-- ========================================== -->
  <!-- ğŸ”” Slack Alert Control Panel              -->
  <!-- ========================================== -->
  <row>
    <panel>
      <title>ğŸ”” Slack Alert Management - Dashboard Event Notifications</title>
      <html>
        <p style="background: #fff3cd; padding: 10px; border-radius: 4px; margin: 10px;">
          <strong>ğŸ“Œ ì£¼ìš” ê¸°ëŠ¥:</strong> ëŒ€ì‹œë³´ë“œ ê° íŒ¨ë„ì— ëŒ€í•œ Slack ì•Œë¦¼ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ON/OFF ì œì–´ + í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì†¡<br/>
          <strong>ğŸ¯ ì§€ì› ì•Œë¦¼:</strong> ì°¨ë‹¨ìœ¨ ë†’ìŒ, ì„¤ì • ë³€ê²½, ì •ì±… ë³€ê²½, ê°ì²´ ë³€ê²½, NAT ë³€ê²½, í¬íŠ¸ í¬ì›Œë”©, ë¹„ì •ìƒ íŠ¸ë˜í”½<br/>
          <strong>ğŸ”‘ í† í° íƒ€ì…:</strong> xoxb-* (Bot Token) ì‚¬ìš© ê¶Œì¥ - Slack App â†’ OAuth &amp; Permissions â†’ Bot User OAuth Token
        </p>
      </html>
    </panel>
  </row>

  <!-- ========================================== -->
  <!-- ğŸ§ª Slack Test Alert (sendalert ë°©ì‹)      -->
  <!-- ========================================== -->
  <row>
    <panel>
      <title>ğŸ§ª Slack í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ì „ì†¡ (í”ŒëŸ¬ê·¸ì¸ ì‚¬ìš©)</title>
      <html>
        <p style="margin: 10px; padding: 10px; background: #e7f3ff; border-radius: 4px;">
          <strong>ğŸ’¡ ì‚¬ìš© ë°©ë²•:</strong> ì•„ë˜ "Search" ë²„íŠ¼ í´ë¦­ â†’ Slack ì±„ë„ í™•ì¸<br/>
          <strong>âš™ï¸ ì„¤ì •:</strong> Settings â†’ Alert Actions â†’ Slack (í”ŒëŸ¬ê·¸ì¸ ì„¤ì •ë¨)
        </p>
      </html>
      <table>
        <search>
          <query>| makeresults count=1
| eval test_time=strftime(now(), "%Y-%m-%d %H:%M:%S"), test_msg="ğŸ§ª í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ì‹œê°„: " + test_time + " ì¥ë¹„: FortiGate-TEST ìƒíƒœ: ì •ìƒ"
| sendalert slack param.channel="#splunk-alerts" param.message=test_msg
| table test_time, test_msg
| rename test_time AS "ì „ì†¡ì‹œê°„", test_msg AS "ë©”ì‹œì§€"</query>
          <earliest>-5m</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>

  <!-- ========================================== -->
  <!-- ğŸ“¨ Slack Alert Transmission History       -->
  <!-- ========================================== -->
  <row>
    <panel>
      <title>ğŸ“¨ Slack Alert Transmission History (Last 24 Hours)</title>
      <table>
        <search>
          <query>index=_internal source=*scheduler.log savedsearch_name="Dashboard_*"
| rex field=savedsearch_name "Dashboard_(?&lt;alert_type&gt;.*)"
| eval alert_korean = case(
    alert_type=="High_Block_Rate", "ğŸ”´ ì°¨ë‹¨ìœ¨ ë†’ìŒ",
    alert_type=="Config_Changes", "âš™ï¸ ì„¤ì • ë³€ê²½",
    alert_type=="Policy_Changes", "ğŸ“‹ ì •ì±… ë³€ê²½",
    alert_type=="Object_Changes", "ğŸ”§ ê°ì²´ ë³€ê²½",
    alert_type=="NAT_Changes", "ğŸ”€ NAT ë³€ê²½",
    alert_type=="Port_Forward_Changes", "ğŸšª í¬íŠ¸ í¬ì›Œë”©",
    alert_type=="High_Traffic_Source", "ğŸ“Š ì¶œë°œì§€ ê³¼ë‹¤",
    alert_type=="High_Traffic_Dest", "ğŸ“Š ëª©ì ì§€ ê³¼ë‹¤",
    alert_type=="Unusual_Ports", "âš ï¸ ë¹„ì •ìƒ í¬íŠ¸",
    1=1, alert_type)
| eval status_korean = case(
    status=="success", "âœ… ì„±ê³µ",
    status=="failure", "âŒ ì‹¤íŒ¨",
    status=="skipped", "â­ï¸ ê±´ë„ˆëœ€",
    1=1, status)
| eval send_time = strftime(_time, "%Y-%m-%d %H:%M:%S")
| eval duration_sec = round(run_time, 2)
| eval result_count_display = if(result_count&gt;0, result_count, "-")
| table send_time, alert_korean, status_korean, result_count_display, duration_sec, app, user
| rename send_time as "ì „ì†¡ì‹œê°„", alert_korean as "ì•Œë¦¼ì¢…ë¥˜", status_korean as "ìƒíƒœ", result_count_display as "ì´ë²¤íŠ¸ìˆ˜", duration_sec as "ì‹¤í–‰ì‹œê°„(ì´ˆ)", app as "ì•±", user as "ì‚¬ìš©ì"
| sort -ì „ì†¡ì‹œê°„</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
          <refresh>30s</refresh>
        </search>
        <option name="count">20</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="percentagesRow">false</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="totalsRow">false</option>
        <option name="wrap">true</option>
        <format type="color" field="ìƒíƒœ">
          <colorPalette type="map">{"âœ… ì„±ê³µ":#53A051,"âŒ ì‹¤íŒ¨":#DC4E41,"â­ï¸ ê±´ë„ˆëœ€":#F8BE34}</colorPalette>
        </format>
        <format type="color" field="ì´ë²¤íŠ¸ìˆ˜">
          <colorPalette type="minMidMax" maxColor="#DC4E41" midColor="#F8BE34" minColor="#53A051"></colorPalette>
          <scale type="minMidMax" midType="number" midValue="5"></scale>
        </format>
      </table>
    </panel>
  </row>

  <!-- ========================================== -->
  <!-- ğŸ“Š Slack Alert Statistics Summary         -->
  <!-- ========================================== -->
  <row>
    <panel>
      <title>ğŸ“Š Slack Alert Statistics (Last 24 Hours)</title>
      <table>
        <search>
          <query>index=_internal source=*scheduler.log savedsearch_name="Dashboard_*" earliest=-24h
| rex field=savedsearch_name "Dashboard_(?&lt;alert_type&gt;.*)"
| eval alert_korean = case(
    alert_type=="High_Block_Rate", "ğŸ”´ ì°¨ë‹¨ìœ¨ ë†’ìŒ",
    alert_type=="Config_Changes", "âš™ï¸ ì„¤ì • ë³€ê²½",
    alert_type=="Policy_Changes", "ğŸ“‹ ì •ì±… ë³€ê²½",
    alert_type=="Object_Changes", "ğŸ”§ ê°ì²´ ë³€ê²½",
    alert_type=="NAT_Changes", "ğŸ”€ NAT ë³€ê²½",
    alert_type=="Port_Forward_Changes", "ğŸšª í¬íŠ¸ í¬ì›Œë”©",
    alert_type=="High_Traffic_Source", "ğŸ“Š ì¶œë°œì§€ ê³¼ë‹¤",
    alert_type=="High_Traffic_Dest", "ğŸ“Š ëª©ì ì§€ ê³¼ë‹¤",
    alert_type=="Unusual_Ports", "âš ï¸ ë¹„ì •ìƒ í¬íŠ¸",
    1=1, alert_type)
| stats
    count as total_runs,
    count(eval(status="success")) as success_count,
    count(eval(status="failure")) as failure_count,
    count(eval(result_count&gt;0)) as triggered_count,
    avg(run_time) as avg_runtime,
    max(_time) as last_run
    by alert_korean
| eval success_rate = round((success_count / total_runs) * 100, 1) . "%"
| eval trigger_rate = round((triggered_count / total_runs) * 100, 1) . "%"
| eval avg_runtime_display = round(avg_runtime, 2) . "ì´ˆ"
| eval last_run_time = strftime(last_run, "%Y-%m-%d %H:%M:%S")
| table alert_korean, total_runs, success_count, failure_count, triggered_count, success_rate, trigger_rate, avg_runtime_display, last_run_time
| rename alert_korean as "ì•Œë¦¼ì¢…ë¥˜", total_runs as "ì´ì‹¤í–‰", success_count as "ì„±ê³µ", failure_count as "ì‹¤íŒ¨", triggered_count as "ë°œì†¡", success_rate as "ì„±ê³µë¥ ", trigger_rate as "ë°œì†¡ë¥ ", avg_runtime_display as "í‰ê· ì‹¤í–‰ì‹œê°„", last_run_time as "ë§ˆì§€ë§‰ì‹¤í–‰"
| sort -ì´ì‹¤í–‰</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
          <refresh>1m</refresh>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="percentagesRow">false</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">true</option>
        <format type="color" field="ì„±ê³µë¥ ">
          <colorPalette type="minMidMax" maxColor="#53A051" midColor="#F8BE34" minColor="#DC4E41"></colorPalette>
          <scale type="minMidMax" midType="percentage" midValue="80"></scale>
        </format>
        <format type="color" field="ë°œì†¡">
          <colorPalette type="minMidMax" maxColor="#DC4E41" midColor="#F8BE34" minColor="#53A051"></colorPalette>
          <scale type="minMidMax" midType="number" midValue="10"></scale>
        </format>
      </table>
    </panel>
  </row>

</form>
